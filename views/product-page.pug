
extends base


include ../mixins/_ratingStars 

block content 


	main.container
		
		.productPage 
		
			.productPage-box
			
				.productPage-box--left
				
					.productPage-box--left-left
					
						each image in product.imageUrls
								img(src=`/img/product_imgs/${image}`, alt=`${product.name}`,  class='productPage-box--img' , width='800' , height='800')
		
					
					.productPage-box--left-right
						img(src=`/img/product_imgs/${product.imageCover}`, alt=`${product.name}`, class='productPage-box--img'  width='800' , height='800')
				
				
				.productPage-box--right
					.productPage__product--heading-box
						h4.productPage__product-name #{product.name}
						if user
							button#add-to-wishlist.productPage__wishlist--btn(data-product-id=`${product.id}`,data-user=user.id , data-product-slug=`${product.slug}`) 
								i.productPage__product--star(data-lucide='star')
						p.productPage_sku Product No. #{product.productSku}
					
					.productPage__text-price--box
					
						.productPage__product--text-box
						
							p.productPage__product--p #{product.description}
							p.productPage__product--p Color: #{product.color}
							p.productPage__product--p Sex: #{product.sex}
							p.productPage__product--p  Tags: #{product.tags}
							
						.productPage__product--price-box
						
							if product.discountPrice < product.currentPrice
								p.productPage__product--p  Original Price
								p.productPage__product--p  $#{product.currentPrice}
								p.productPage__product--p  Sale Price
								p.checkout__price $#{product.discountPrice}
							else 
								p.productPage__product--p  Current Price
								p.checkout__price $#{product.currentPrice}
						
						
						
						
					////-------- Variants -------// 
					
					.productPage__variant-size--flex
						each variant, i in product.variants 
							if variant.inStock > 0
								button(class=`product__size--btn variant__size--${i+1}` , data-variant=variant._id) #{variant.size}
								
					////-- ------------------- --// 
					
					if user		
						.productPage__quantity
							label(for=`quantity`)  Quantity:
							input#add-to-cart-qty(type="number" name=`quantity` value="1" min="1")

						.productPage__product--btn-box 
						
							button#add-to-cart.productPage__product-btn(data-product-id=`${product.id}`,data-user=user.id , data-product-slug=`${product.slug}`) Add to cart 
							
							button#buy-it-now.productPage__product-btn(data-product-id=`${product.id}`,data-user-object=user , data-product-slug=`${product.slug}`) Buy now
					else
						.productPage__product--btn-box 
						
							button#buy-it-now-guest.productPage__product-btn(data-product-id=`${product.id}`,data-user-object=user , data-product-slug=`${product.slug}`) Buy now
				
				
				
				
			.productPage__reviews
			
				h2.productPage__reviews--heading.mrgbtm--med  Customer Ratings
				
				.productPage__reviews--top-box
				
					p Overall Rating: #{product.rating} (#{product.totalRatings})
					
					if user
					
						if hasPurchased
						
							if !hasReviewed
							
								button#product-review-btn Leave Review
								
							else 
								p Review Submitted
						
				
				
				.productPage__reviews--bottom-box.content-hidden
				
					form#submit-review-form.review-form(data-product-id=`${product.id}` , data-slug=`${product.slug}`)
					
						.review-form-row.review-form-row--input
							label(for="review-rating")  Rating:
							input#review-rating(type="number" , name='review-rating' , min='1' , max='10', required )
							
						.review-form-row.review-form-row--textarea
							label(for="review-comment")  Comment:
							textarea#review-comment(name="review-comment" placeholder="Write your comment..." rows="3" required)
							button#review-cancel-btn Cancel
							button(type='submit') Submit
					
				
				
				.productPage__reviews--middle-box
					each review in product.reviews 
						.productPage__review--box
							.productPage__review
								h4 #{review.user.name.toUpperCase()}
								p Rating: #{review.rating} / 10
								p Comment: #{review.comment}
								
							+ratingStar(review)
				

		
